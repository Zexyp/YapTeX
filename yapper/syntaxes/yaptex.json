{
  "scopeName": "source.yaptex",
  "injectionSelector": "L:text.html.markdown",
  "patterns": [
    {
      "match": "^#(?:endregion|enddef|pagebreak|else|endif)",
      "name": "keyword.control"
    },
    {
      "match": "^#(?:region|include|embed|warning|error)\\s+(\")((?:\\\\.|[^\"\\\\])*)(\")",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "punctuation.definition.string.begin"
        },
        "2": {
          "name": "string"
        },
        "3": {
          "name": "punctuation.definition.string.end"
        }
      }
    },
    {
      "match": "^#(?:copy)\\s+(\")((?:\\\\.|[^\"\\\\])*)(\")\\s+(\")((?:\\\\.|[^\"\\\\])*)(\")",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "punctuation.definition.string.begin"
        },
        "2": {
          "name": "string"
        },
        "3": {
          "name": "punctuation.definition.string.end"
        },
        "4": {
          "name": "punctuation.definition.string.begin"
        },
        "5": {
          "name": "string"
        },
        "6": {
          "name": "punctuation.definition.string.end"
        }
      }
    },
    {
      "match": "%(?:([a-zA-Z_][a-zA-Z0-9_]*)|\\{([a-zA-Z_][a-zA-Z0-9_]*)(?:(:)([a-z]+))?\\})",
      "name": "storage.modifier",
      "captures": {
        "1": {
          "name": "meta.function"
        },
        "2": {
          "name": "meta.function"
        },
        "3": {
          "name": "punctuation"
        },
        "4": {
          "name": "meta.function"
        }
      }
    },
    {
      "match": "\\?([a-zA-Z_][a-zA-Z0-9_]*)(?:(\\()(\\s*.+\\s*)(\\)))?",
      "name": "storage.modifier",
      "captures": {
        "1": {
          "name": "meta.function"
        },
        "2": {
          "name": "punctuation"
        },
        "3": {
          "name": "string"
        },
        "4": {
          "name": "punctuation"
        }
      }
    },
    {
      "match": "^#set\\s+([a-zA-Z_][a-zA-Z0-9_]*)(?:\\s+|\\s*(=)\\s*)(?:(-?\\d+)|(\")((?:\\\\.|[^\"\\\\])*)(\"))",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "meta.function"
        },
        "2": {
          "name": "keyword.operator"
        },
        "3": {
          "name": "constant.numeric"
        },
        "4": {
          "name": "punctuation.definition.string.begin"
        },
        "5": {
          "name": "string"
        },
        "6": {
          "name": "punctuation.definition.string.end"
        }
      }
    },
    {
      "match": "^#(?:inc|dec)\\s+([a-zA-Z_][a-zA-Z0-9_]*)(?:\\s+(-?\\d+))?",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "meta.function"
        },
        "2": {
          "name": "constant.numeric"
        }
      }
    },
    {
      "match": "^#(?:if|ifn|elif|elifn|ifdef|ifndef|elifdef|elifndef)\\s+((?:[a-zA-Z_][a-zA-Z0-9_]*)(?:\\s*(?:&&|\\|\\|)\\s*(?:[a-zA-Z_][a-zA-Z0-9_]*))*)",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "meta.function"
        }
      }
    },
    {
      "match": "^#undef\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "meta.function"
        }
      }
    },
    {
      "match": "^#define\\s+([a-zA-Z_][a-zA-Z0-9_]*)(?:(\\()\\s*([a-zA-Z_][a-zA-Z0-9_]*\\s*(?:\\s*;\\s*[a-zA-Z_][a-zA-Z0-9_]*)*)\\s*(\\)))?",
      "name": "keyword.control",
      "captures": {
        "1": {
          "name": "meta.function"
        },
        "2": {
          "name": "punctuation"
        },
        "3": {
          "name": "string"
        },
        "4": {
          "name": "punctuation"
        }
      }
    },
    {
      "match": "^(\\\\)#[a-z]+",
      "name": "",
      "captures": {
        "1": {
          "name": "comment"
        }
      }
    },
    {
      "match": "(\\\\)(?:\\?|%)\\w+",
      "name": "",
      "captures": {
        "1": {
          "name": "comment"
        }
      }
    },
    {
      "match": "(\\\\)%{[\\w:]+}",
      "name": "",
      "captures": {
        "1": {
          "name": "comment"
        }
      }
    }
  ]
}